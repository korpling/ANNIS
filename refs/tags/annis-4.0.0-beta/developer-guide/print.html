<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>ANNIS Developer Guide</title>
        
        <meta name="robots" content="noindex" />
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "light" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div id="sidebar-scrollbox" class="sidebar-scrollbox">
                <ol class="chapter"><li class="expanded "><a href="architecture.html"><strong aria-hidden="true">1.</strong> Architecture</a></li><li class="expanded "><a href="building.html"><strong aria-hidden="true">2.</strong> Building</a></li><li class="expanded "><a href="release.html"><strong aria-hidden="true">3.</strong> Making a new ANNIS release</a></li><li class="expanded "><a href="querybuilder.html"><strong aria-hidden="true">4.</strong> Create new query builder</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <div class="left-buttons">
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </button>
                            <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                                <i class="fa fa-paint-brush"></i>
                            </button>
                            <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                                <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            </ul>
                            
                            <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                                <i class="fa fa-search"></i>
                            </button>
                            
                        </div>

                        <h1 class="menu-title">ANNIS Developer Guide</h1>

                        <div class="right-buttons">
                            <a href="print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                            
                        </div>
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#architecture" id="architecture">Architecture</a></h1>
<p>ANNIS is a web-based search and visualization architecture for
multi-layer corpora. ANNIS consists of two major components: a backend
service and a web front-end.</p>
<h2><a class="header" href="#backend-service" id="backend-service">Backend Service</a></h2>
<p>The service is part of the graphANNIS project and provides a REST API to query and manage corpora.
GraphANNIS directly implements all needed functionality without the need of an external database.
See the <a href="https://korpling.github.io/graphANNIS/docs/v0.30/">graphANNIS documentation</a> for more information about the <a href="https://korpling.github.io/graphANNIS/docs/v0.30/rest.html">REST service</a>.</p>
<h2><a class="header" href="#web-front-end" id="web-front-end">Web Front-end</a></h2>
<p>The ANNIS front-end is a web application implemented in Java and the <a href="https://vaadin.com/">Vaadin</a> framework and runs in a normal browser (we recommend Mozilla Firefox). 
The server running the web-application communicates with the backend service via a REST interface.
Per default, the web front-end includes a released version of the backend service and starts an instance of it.
The front-end uses Spring Boot internally and bundles it own server, so you don't need a Tomcat or Jetty installation to run it.</p>
<h1><a class="header" href="#building" id="building">Building</a></h1>
<p>ANNIS uses <a href="http://maven.apache.org/">Maven3</a>  as build tool. Maven itself is
based on Java and should run on every major operating system. You have to
download and install the appropriate version for your operating system from
<a href="http://maven.apache.org/download.html">http://maven.apache.org/download.html</a> before you can build ANNIS. Maven will
download all needed dependencies from central servers on the first build so you
will need to have a working internet connection. The dependencies are cached
locally once their are downloaded.</p>
<p>When you have downloaded or checked out the source of ANNIS the top-level
directory of the source code is the parent project for all ANNIS sub-projects. If
you want to build every project that is part of ANNIS just execute</p>
<pre><code class="language-{.sh}">cd &lt;annis-sources&gt;/
mvn install
</code></pre>
<p>This might take a while on the first execution. <code>mvn clean</code> will remove all compiled
code if necessary.</p>
<p>If you only want to compile a sub-project execute <code>mvn install</code> in the
corresponding sub-directory. Every folder with a sub-project will have a pom.xml
file. These files configure the whole build process. The Maven documenation
contains detailed explanations of the structure and possible content of the
configuration files.</p>
<p>Some sub-projects don't provide a library but will produce a zip or tar/gz-
file when they are compiled. These assembly steps (see <a href="http://maven.apache.org/plugins/maven-assembly-plugin/">Maven Assembly documentation</a>) are automatically
invoked on <code>mvn install</code>.</p>
<h2><a class="header" href="#using-an-ide" id="using-an-ide">Using an IDE</a></h2>
<p>While you can use any text editor of your choice to change ANNIS and compile
it completely on the command line using Maven, a proper IDE will be a huge help
for you. You can use any IDE which has a good support for Maven. The ANNIS
main developers currently recommend Eclipse or Visual Studio Code for devlopment.</p>
<h2><a class="header" href="#running-the-service" id="running-the-service">Running the service</a></h2>
<p>The <code>annis-gui</code> project contains two build artifacts: </p>
<ul>
<li><code>annis-gui-&lt;version&gt;-server.jar</code> and</li>
<li><code>annis-gui-&lt;version&gt;-desktop.jar</code></li>
</ul>
<p>You can execute both JAR-files to run the front-end and the embedded REST service.</p>
<pre><code class="language-bash">cd &lt;unzipped source&gt;/annis-gui/
java -jar target/annis-gui-&lt;version&gt;-server.jar
</code></pre>
<p>The desktop variant will open a simple window with a link to the URL on which the service is listening.</p>
<p>After starting the service, you can access the site under <a href="http://localhost:5711">http://localhost:5711/</a>. 
The service can be stopped by pressing <kbd>CTRL</kbd>+<kbd>C</kbd>.</p>
<h1><a class="header" href="#making-a-new-annis-release" id="making-a-new-annis-release">Making a new ANNIS release</a></h1>
<h2><a class="header" href="#introduction" id="introduction">Introduction</a></h2>
<p>The release process, including all necessary tests, might take several days and includes fixing bugs that are only discovered in the release testing process. 
<strong>Never ever add new features in this release process</strong>, there is the separate &quot;develop&quot; branch which you can use for this purposes.</p>
<p>You must have <a href="https://github.com/rust-lang-nursery/mdBook">mdBook</a> installed to make a release.
Otherwise the documentation can't be created.</p>
<h2><a class="header" href="#release-process" id="release-process">Release Process</a></h2>
<h3><a class="header" href="#initialization-phase" id="initialization-phase">Initialization phase</a></h3>
<ol>
<li><strong>Start</strong> the release process by executing <code>mvn gitflow:release-start</code> for a regular release (branched from <code>develop</code>) or <code>mvn gitflow:hotfix-start</code> for a hotfix that is branched from <code>master</code>. The command will ask you for the new version number, use <a href="https://semver.org/">semantic versioning</a>.</li>
<li><strong>Add new changelog entries</strong>, if some important information is missing add an entry to the changelog.
When the changelog is up-to-date, execute</li>
</ol>
<pre><code class="language-bash">mvn -N keepachangelog:release cff:create cff:third-party-folder
</code></pre>
<p>and commit your changes.
This will also update the citation file (<code>CITATION.cff</code>) and the contents of the <code>THIRD-PARTY</code> folder.</p>
<h3><a class="header" href="#testing-cycle" id="testing-cycle">Testing cycle</a></h3>
<ol>
<li><strong>Build</strong> the complete project <em>with</em> tests.</li>
</ol>
<pre><code class="language-bash">mvn clean install
</code></pre>
<ol start="2">
<li><strong>Do manual tests.</strong> If you have to fix any bug document it in the issue tracker, update the changelog and start over at step 1.
If no known bugs are left to fix go to the next section. </li>
</ol>
<h3><a class="header" href="#finish-phase" id="finish-phase">Finish phase</a></h3>
<ol>
<li><strong>Finish</strong> the release by executing either <code>mvn gitflow:release-finish</code> for regular releases or <code>mvn gitflow:hotfix-finish</code> for hotfixes.</li>
<li><strong>Release</strong> the staging repository to Maven Central with the Nexus interface: <a href="https://oss.sonatype.org/">https://oss.sonatype.org/</a></li>
<li>Create a new <strong>release on GitHub</strong> including the changelog. Upload the binaries from Maven repository to GitHub release as well.</li>
</ol>
<p>A new version of the User and Developer Guide will be deployed by the GitHub Actions CI.</p>
<h1><a class="header" href="#create-new-query-builder" id="create-new-query-builder">Create new query builder</a></h1>
<p>A query builder is a class that</p>
<ol>
<li>implements the <code>QueryBuilderPlugin</code> interface</li>
<li>has the <code>@PluginImplementation</code> annotation</li>
</ol>
<p>When implementing the interface you have to provide a short name, a caption
and a callback function that creates new Vaadin components. You get an object
of the type <code>QueryController</code> which you can use to set new queries from your
component.</p>
<p>A query builder plugin must be either registered in the <code>addCustomUIPlugins()</code> function
of the <code>SearchUI</code> (if the plugin is part of the annis-gui project) or must be
added to a JAR-file that is located at one of the following locations:</p>
<ul>
<li>the plugins folder inside the deployed web application</li>
<li>the path defined in the <code>ANNIS_PLUGINS</code> environment variable</li>
</ul>
<p>Please also note that it is possible to configure a default query builder for an
instance. Further information can be found in the User Guide.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        

                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                

                
            </nav>

        </div>

        

        

        
        
        
        <script type="text/javascript">
            window.playpen_copyable = true;
        </script>
        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        
        
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
        
        

    </body>
</html>
